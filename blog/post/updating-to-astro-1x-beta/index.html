<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Meta --><meta charset="UTF-8">
<meta name="description" content="Portfolio of James Mejia, Designer & Front-End Developer">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="msvalidate.01" content="78F25BA9CB8A744B0E3C891CE2F772E8">
<!-- /Meta -->

<!-- Title -->
<title>Updating to AstroJS 1x beta</title>
<!-- /Title -->

<!-- Styles -->
<link rel="stylesheet" href="/styles.css">
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Aleo:wght@300;400&family=Fira+Code&display=swap" rel="stylesheet">
<!-- /Styles -->

<!-- Scripts -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-50373766-1"></script>

<!-- /Scripts -->

<!-- Favicons -->
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<!-- /Favicons -->

  <script type="module" src="/hoisted.baea1369.js"></script></head>
  <body>
    <a href="#main-content" class="skip-to-content">Skip to content</a>
    <header id="top" class="main-header" role="banner">
      <div class="main-header__inner wrap">
        <nav class="main-nav" role="navigation">
  <div class="main-nav__inner">
    <button class="js-nav-trigger main-nav__trigger" type="button" aria-expanded="false" aria-label="Menu toggle" aria-controls="main-nav">
      <span class="line__wrap"></span>
      <span class="trigger__label">Menu</span>
    </button>
    <ul id="main-nav" class="js-nav main-nav__menu nav">
      <li class="nav__item">
        <a href="/" class="nav__link">
          Home
        </a>
      </li><li class="nav__item">
        <a href="/blog" class="nav__link">
          Blog
        </a>
      </li><li class="nav__item">
        <a href="#contact" class="nav__link">
          Contact
        </a>
      </li><li class="nav__item">
        <a href="/resume" class="nav__link">
          Resume
        </a>
      </li>
    </ul>
  </div>
</nav>
      </div>
    </header>
    <main id="main-content">
      <div class="wrap">
        <h1>Updating to AstroJS 1x beta</h1><time datetime="2022-06-20T00:00:00.000Z">June 20, 2022</time><p>When I originally implemented <a href="https://astro.build/">AstroJS</a> on this site, it was on version <code>0.20.12</code>. Almost a year later, I wanted to update to the latest version before I started implementing bigger features.</p><p>Based on semantic versioning the jump from <code>0.20.12</code> to <code>1.0.0-beta.36</code> is pretty big. Thankfully, the upgrade process wasn’t too bad.</p><h2 id="differences">Differences</h2><p>Configs had changed and my site wouldn’t run after upgrading. This was a bit of a surprise, but not unexpected. I headed over to the release changelogs found my version, <a href="https://github.com/withastro/astro/blob/main/packages/astro/CHANGELOG.md#02012"><code>0.20.12</code></a>. From there I started working my way up to see if I could find anything that would help me debug.</p><p>Below are some changes I did to get this little site working again.</p><h3 id="simpler-configs">Simpler configs</h3><p>Configs seemed to require less, that’s great! What I didn’t realize was part of making simpler configs was breaking up stuff that was previously built in. I now needed to import <code>defineConfig</code> from <code>astro/config</code>, pass my overrides, and export that.</p><pre class="astro-code" style="background-color: #0d1117; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #C9D1D9">// astro.config.mjs</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span> export default {</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span>   …Your overrides</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span> import { defineConfig } from &quot;astro/config&quot;;</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span></span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span> // https://astro.build/config</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span> export default defineConfig({</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span>   …Your overrides</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span> });</span></span>
<span class="line"><span style="color: #C9D1D9">};</span></span></code></pre><p>Sitemaps are also no longer built-in. That’s now a plugin that you need to install and load separately. That makes sense, why load something by default that you might not even use.</p><pre class="astro-code" style="background-color: #0d1117; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> { defineConfig } </span><span style="color: #FF7B72">from</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">&quot;astro/config&quot;</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">import</span><span style="color: #C9D1D9"> sitemap </span><span style="color: #FF7B72">from</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">&quot;@astrojs/sitemap&quot;</span><span style="color: #C9D1D9">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #8B949E">// https://astro.build/config</span></span>
<span class="line"><span style="color: #FF7B72">export</span><span style="color: #FFA657"> </span><span style="color: #FF7B72">default</span><span style="color: #FFA657"> </span><span style="color: #D2A8FF">defineConfig</span><span style="color: #FFA657">({</span></span>
<span class="line"><span style="color: #FFA657">  </span><span style="color: #C9D1D9">integrations: [</span><span style="color: #D2A8FF">sitemap</span><span style="color: #C9D1D9">()]</span></span>
<span class="line"><span style="color: #FFA657">})</span><span style="color: #C9D1D9">;</span></span></code></pre><p>This website was originally a 1-page site, so there wasn’t much to it. Here’s a full diff of changes. You can see how much was no longer needed.</p><pre class="astro-code" style="background-color: #0d1117; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #C9D1D9">// astro.config.mjs</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span> export default {</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span>  // projectRoot: &#39;.&#39;,     // Where to resolve all URLs relative to. Useful if you have a monorepo project.</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span>  pages: &#39;./src/pages&#39;, // Path to Astro components, pages, and data</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span>  dist: &#39;./dist&#39;,       // When running `astro build`, path to final static output</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span>  public: &#39;./public&#39;,   // A folder of static files Astro will copy to the root. Useful for favicons, images, and other files that don’t need processing.</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span>  buildOptions: {</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span>    site: &#39;https://www.jmejia.com/&#39;,  // Your public domain, e.g.: https://my-site.dev/. Used to generate sitemaps and canonical URLs.</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span>    sitemap: true,      // Generate sitemap (set to &quot;false&quot; to disable)</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span>  },</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span>  devOptions: {</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span>    // port: 3000,         // The port to run the dev server on.</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span>    // tailwindConfig: &#39;&#39;, // Path to tailwind.config.js if used, e.g. &#39;./tailwind.config.js&#39;</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span>  },</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span>  renderers: [&#39;@astrojs/renderer-preact&#39;],</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span>  import { defineConfig } from &quot;astro/config&quot;;</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span>  import sitemap from &quot;@astrojs/sitemap&quot;;</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span></span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span>  // https://astro.build/config</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span>  export default defineConfig({</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span>    site: &quot;https://www.jmejia.com/&quot;,</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span>    integrations: [sitemap()]</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span>  });</span></span>
<span class="line"><span style="color: #C9D1D9">};</span></span></code></pre><h3 id="fetching-data">Fetching data</h3><p>Data fetching in Portfolio examples also stopped working because that had changed as well. You now need to call an async function in <code>Astro.glob</code>, instead of <code>fetchContent</code>.</p><pre class="astro-code" style="background-color: #0d1117; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span> const projectPreviews = Astro.fetchContent(&#39;./project/**/*.md&#39;);</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span> const projectPreviews = await Astro.glob(&#39;./project/**/*.md&#39;);</span></span></code></pre><h3 id="template-changes">Template changes</h3><p>Once that I got rid of those initial <code>npm start</code> errors, I ran into a few more because of required template changes.</p><p>Using data inside of HTML elements no longer required quotes.</p><pre class="astro-code" style="background-color: #0d1117; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span> &lt;a href=&quot;{ navItem.url }&quot; class=&quot;nav__link&quot;&gt;</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span> &lt;a href={ navItem.url } class=&quot;nav__link&quot;&gt;</span></span></code></pre><p>The site examples on the homepage are powered by markdown files that include basic information like the project title, my role, a brief description of the work involved, and a link to visit the site.</p><p>That stopped working because I now needed to reference the markdown file’s frontmatter.</p><pre class="astro-code" style="background-color: #0d1117; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;"><code><span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span> &lt;h4 class=&quot;project__title&quot;&gt;{ project.title }&lt;/h4&gt;</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span> &lt;ul class=&quot;project-roles h4 nav nav--inline&quot;&gt;</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span>   &lt;li class=&quot;nav__item project-role&quot;&gt;{ project.role }&lt;/li&gt;</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span> &lt;/ul&gt;</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span> &lt;p&gt;</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span>   { project.description }</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span> &lt;/p&gt;</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span> &lt;a href={ project.cta }&gt;</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span>   Visit &lt;span class=&quot;visually-hidden&quot;&gt;{ project.title }&lt;/span&gt; Site</span></span>
<span class="line"><span style="color: #FFA198"><span style="user-select: none;">-</span> &lt;/a&gt;</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span> &lt;h4 class=&quot;project__title&quot;&gt;{ project.frontmatter.title }&lt;/h4&gt;</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span> &lt;ul class=&quot;project-roles h4 nav nav--inline&quot;&gt;</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span>   &lt;li class=&quot;nav__item project-role&quot;&gt;{ project.frontmatter.role }&lt;/li&gt;</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span> &lt;/ul&gt;</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span> &lt;p&gt;</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span>   { project.frontmatter.description }</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span> &lt;/p&gt;</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span> &lt;a href={ project.frontmatter.cta }&gt;</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span>   Visit &lt;span class=&quot;visually-hidden&quot;&gt;{ project.frontmatter.title }&lt;/span&gt; Site</span></span>
<span class="line"><span style="color: #7EE787"><span style="user-select: none;">+</span> &lt;/a&gt;</span></span></code></pre><p>These template updates weren’t the worst, but definitely wished for a migration guide. You can view the full list of changes in the pull request <a href="https://github.com/mejiaj/mejiaj/pull/24">Upgrade to Astro 1x beta</a>.</p>
      </div>
    </main>
    <footer class="main-footer" role="contentinfo" id="contact">
  <nav class="nav footer-nav" aria-label="Footer menu">
    <ul class="footer-nav__menu">
      <li class="footer-nav__menu-item">
          <a href="#top" class="footer-nav__menu-link" aria-label="{ footerItem.aria_label }">
            <svg role="img" aria-hidden="true" class="footer__icon footer__icon--no-text icon">
              <use xlink: href="#up-arrow"></use>
            </svg>
              
          </a>
        </li><li class="footer-nav__menu-item">
          <a href="mailto:me@jmejia.com" class="footer-nav__menu-link" aria-label="{ footerItem.aria_label }">
            <svg role="img" aria-hidden="true" class="footer__icon footer__icon--no-text icon">
              <use xlink: href="#email"></use>
            </svg>
              Email
          </a>
        </li><li class="footer-nav__menu-item">
          <a href="https://codepen.io/mejiaj/" class="footer-nav__menu-link" aria-label="{ footerItem.aria_label }">
            <svg role="img" aria-hidden="true" class="footer__icon footer__icon--no-text icon">
              <use xlink: href="#social-codepen"></use>
            </svg>
              Codepen
          </a>
        </li><li class="footer-nav__menu-item">
          <a href="https://www.linkedin.com/in/mejiajames/en" class="footer-nav__menu-link" aria-label="{ footerItem.aria_label }">
            <svg role="img" aria-hidden="true" class="footer__icon footer__icon--no-text icon">
              <use xlink: href="#social-linkedin"></use>
            </svg>
              LinkedIn
          </a>
        </li>
    </ul>
  </nav>
</footer>

<svg xmlns="https://www.w3.org/2000/svg" style="display: none;">
  <symbol id="email" viewBox="0 0 512 512">
    <title>email icon</title>
    <path d="M67 148.7c11 5.8 163.8 89.1 169.5 92.1 5.7 3 11.5 4.4 20.5 4.4s14.8-1.4 20.5-4.4c5.7-3 158.5-86.3 169.5-92.1 4.1-2.1 11-5.9 12.5-10.2 2.6-7.6-.2-10.5-11.3-10.5H65.8c-11.1 0-13.9 3-11.3 10.5 1.5 4.4 8.4 8.1 12.5 10.2zM455.7 153.2c-8.2 4.2-81.8 56.6-130.5 88.1l82.2 92.5c2 2 2.9 4.4 1.8 5.6-1.2 1.1-3.8.5-5.9-1.4l-98.6-83.2c-14.9 9.6-25.4 16.2-27.2 17.2-7.7 3.9-13.1 4.4-20.5 4.4s-12.8-.5-20.5-4.4c-1.9-1-12.3-7.6-27.2-17.2L110.7 338c-2 2-4.7 2.6-5.9 1.4-1.2-1.1-.3-3.6 1.7-5.6l82.1-92.5c-48.7-31.5-123.1-83.9-131.3-88.1-8.8-4.5-9.3.8-9.3 4.9v205c0 9.3 13.7 20.9 23.5 20.9h371c9.8 0 21.5-11.7 21.5-20.9v-205c0-4.2.6-9.4-8.3-4.9z"></path>
  </symbol>
  <symbol id="social-codepen" viewBox="0 0 512 512">
    <title>social-codepen icon</title>
    <path d="M241.24 303.936c-15.323-10.357-30.743-20.57-46.063-30.93-2.03-1.373-3.43-1.472-5.502-.03l-38.87 26.155C181.964 319.906 244 361.318 244 361.318V307.53c-.012-1.223-1.553-2.78-2.76-3.594zM195.092 240.666c15.454-10.16 30.85-20.41 46.11-30.86 1.485-1.018 2.774-3.51 2.798-5.334v-51.706s-62.033 41.124-93.262 61.942c13.7 9.16 26.67 17.913 39.787 26.443 1.02.663 3.396.285 4.567-.484zM269.838 209.354c15.81 10.703 31.683 21.314 47.627 31.815.916.603 2.92.6 3.84 0l39.75-26.468L268 152.484v53.35c.01 1.2.805 2.82 1.838 3.52zM258.11 230.37c-1.21-.803-3.612-.53-4.744.167-4.817 2.962-9.463 6.203-14.164 9.355-8.248 5.53-25.356 17.023-25.356 17.023l38.842 25.865c1.748 1.157 4.436 1.22 6.26.11l39.014-25.992s-34.08-22.7-39.853-26.53zM141 237.116v39.61l29.622-19.84zM256 32C132.288 32 32 132.288 32 256s100.288 224 224 224 224-100.288 224-224S379.712 32 256 32zm139 265.006c0 5.785-2.652 9.868-7.51 13.094-41.143 27.314-82.252 54.714-123.287 82.188-5.854 3.918-11.174 3.754-16.984-.137-40.784-27.313-81.72-54.545-122.626-81.675-5.11-3.39-7.594-7.557-7.594-13.73v-79.73c0-6.14 2.52-10.33 7.624-13.715 40.906-27.13 81.94-54.363 122.724-81.676 5.818-3.896 11.094-4.007 16.938-.095 41.036 27.473 82.126 54.868 123.26 82.194 4.68 3.106 7.454 6.943 7.454 12.66v80.622zM316.247 273.234c-15.054 10.222-30.188 20.326-45.386 30.332-2.41 1.588-2.887 3.318-2.86 6.19V361.1l93.04-62.003-38.528-25.882c-2.345-1.604-3.93-1.567-6.265.02zM370 276.676V237.06l-29.59 19.873z"></path>
  </symbol>
  <symbol id="social-linkedin" viewBox="0 0 512 512">
    <title>social-linkedin icon</title>
    <path d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z"></path>
  </symbol>
  <symbol id="up-arrow" viewBox="0 0 512 512">
    <title>up arrow</title>
    <path d="M348.3 216.4c-5 5.1-13.3 5.1-18.4.1L269 155.8v231.3c0 7.1-5.8 12.9-13 12.9s-13-5.8-13-12.9V155.8l-60.9 60.8c-5.1 5-13.3 4.9-18.4-.1-5-5.1-5-13.2.1-18.3l83-82.4c1.2-1.1 2.5-2 4.1-2.7 1.6-.7 3.3-1 5-1 3.4 0 6.6 1.3 9.1 3.7l83 82.4c5.2 4.9 5.3 13.1.3 18.2z"></path>
  </symbol>
</svg>

  </body></html>